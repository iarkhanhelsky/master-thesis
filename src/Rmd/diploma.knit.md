---
title: Анализ разладки последовательности
bibliography: references.bib
csl: style/citations.csl
---






# Введение
Преобразование Фурье является достаточно популярным и хорошо изученным инструментом в сфере обработки сигналов и анализа временных рядов.
Публикация работы Блэкмэна (Blackman) и Туки (Tukey) "Измерение энергетического спектра (The measurment of power spectra)"[@blacktukey], а так же Кули (Coley) и Tуки (Tuckey) "Алгоритм машинного вычисления сложных рядов Фурье (An algorithm of machine computation of complex Fourier series)" [@cooltukey] привели к значительным успехам в сфере спектрального анализа временных рядов.

При этом данная методика в некоторых случаях обладает явными недостатками. Сигнал $x(t)$[^or-series] содержит полную информацию во временном пространстве, то есть амплитуду сигнала в каждый фиксированный момент времени $t_0$. Однако, из $x(t)$ невозможно напрямую получить информацию описывающую частотную характеристику сигнала. С другой стороны, разложение $X(f)$ полученное с помощью преобразовнаия Фурье сингнала $x(t)$ содержит в себе всю информацию о сигнале в частотном пространстве: магнитуду и фазовый угол каждой частотной компоненты $f$. Но теперь, нет ни какой информации о том где конкретно во времени та или иная частота появилась. Иными словами ни $x(t)$, ни $X(f)$ не дают полного описания сигнала.

[^or-series]:
  Здесь и далее мы не будем делать явного различия между понятиями *сигнал* и *временной ряд*, если не оговрено обратное

Чтобы разрешить эту проблему, мы можем использовать оконное преобразование Фурье, т.е. обрезать сигнал $x(t)$ временным окном $\omega(t - \tau)$:
\begin{equation}
    x'(t) = \omega(t - \tau) x(t),
\end{equation}

где само окно имеет ширину $T$ и может смещаться во времени с изменением параметра $\tau$:
\begin{equation}
    \omega(t) =
    \begin{cases}
        1, t \in [0, T] \\
        0, t \not\in [0, T]
    \end{cases}
\end{equation}

Так мы получим разложение сигнала лишь для определенного периода $T$. Недостатком такого преобразования является сильное искажение в частотном пространстве, вызванное резким обрезанием сигнала вне окна. Чтобы уменьшить это искажение, прямоугольное окно может быть заменено более гладким Гауссовским окном с постепенным спадом:
\begin{equation} x'(t) = g(t) x(t), ~ g(t) = c \exp{((t - \tau)^2 / \sigma ^ 2)}\end{equation}

С другой стороны, мы можем считать что обрезанный сигнал $x(t)$ повторяется во времени с конечным периодном $T$. В этом случае, разложение становится дискретным, содержащим конечное число чатотных компонент $X[k]~(k = 0, \pm 1, \pm 2, \dots)$  для дискретных частот $f = kf_0 =  k/ T$. В таком случае информация о любой частоте в промежутке между $X[k]$ и $X[k + 1]$ потеряна. Более того, чем большую детализацию мы получаем во временном пространстве уменьшая $T$, тем меньшую детализацию в частотном пространстве мы получаем из-за увеличаения промежутков $f_0 = 1 / T$ между частотными компонентами.

Мы видим, что просто невозможно получить полную информацию о сигнале сразу во временном и частотном пространствах, так как увеличивая детатлизацию в одном пространстве мы автоматически уменьшаем ее в другом.

Если характеристики сигнала меняются с течением времени незначительно, то есть сигнал стационарен, тогда преобрзавование Фурье подходит для анализа. Однаком, во многих приложениях сигнал быстроменяющийся или нестационарный(например есть тренд или резкие скачки). В этих случаях анализ с помощью преобразования Фурье неспособен определить где или когда эти изменения имели место.

С целью преодолеть недостатки этого метода и получить необходимую информацию сразу во временном и частотном пространствах, используется другое преобразование, названное __вейвлет-преобразованием__.

# Вейвлет преобразование. Вейвлет спектр временного ряда. 

## Вейвлет. Определение. Основные понятия.
Любая локализованная $\mathbb{R}$-функция $\psi \in L_2(\mathbb{R})$, где $L_2([a,b])$ - множество интегрируемых в квадратах функций, называется $\mathbb{R}$-вейвлетом (или просто вейвлетом), если для нее существует функция $\overset{*}{\psi} \in L_2(\mathbb{R})$ такая, что семейства $\lbrace\psi_{jk}\rbrace$ и $\lbrace\overset{*}{\psi_{jk}}\rbrace$, построенные как

$$
\psi_{jk}(t) = 2^{j/2}\psi(2^jt-k), ~~ j,k \in \mathbb{Z}
$$

и

$$
 \psi^{jk}(t) = \overset{*}{\psi_{jk}}(t) = 2^{j/2}\overset{*}{\psi}(2^jt-k)
$$

являются парными базисами функционального пространства $L_2(\mathbb{R})$[@daub].

Каждый таким образом определенный вейвлет $\psi$, независимо от того, ортогональный он или нет, позволяет любую функцию $f \in L_2(\mathbb{R})$ представить в виде ряда
$$
  f(t) = \sum_{j,k = -\infty}^{\infty} c_{jk}\psi_{jk}(t)
$$

коэффициенты которого определяются интегральным вейвлет-преобразованием $f$ относительно $\overset{*}{\psi}$.
Вейвлет-двойник $\overset{*}{\psi}$ -- единственный и сам является $\mathbb{R}$-вейвлетом. Пара $(\psi, \overset{*}{\psi})$ симметрична в том смысле, что $\psi$ в свою очередь является двойником для $\overset{*}{\psi}$.
Если $\mathbb{R}$-вейвлет $\psi$ обладает свойством ортоганальности, то $\overset{*}{\psi} \equiv \psi$, и $\lbrace \overset{*}{\psi_{jk}} \rbrace \equiv \lbrace \psi_{jk} \rbrace$ -- ортогональный базис.

Для многих практических целей достаточно, чтобы вейвлет обладал свойством полуортогональности, т.е. чтобы его базис Рисса [^riss] $\lbrace \psi_{jk} \rbrace$ удовлетворял условию $\langle \psi_{jk},  \psi_{lm}\rangle = 0$ при $j = l, ~ j,k,l,m \in \mathbb{Z}$.

[^riss]:
  _Система Рисса_ с постоянными $A$ и $B$ — такая система векторов $\{f_n\}_{n=1}^\infty \in H$ в гильбертовом пространстве *H*, что для любой последовательности комплексных чисел $c=\{c_n\}_{n=1}^\infty \in l_2$ ряд $\sum_{n=1}^\infty c_nf_n$ сходится по норме в *H*, причем
  $A\|c\|^2_{l_2}\leqslant \left\| \sum_{n=1}^\infty c_n f_n \right\|^2_H \leqslant B\|c\|^2_{l_2}$,
  _Базис Рисса_ — такая система Рисса, которая является базисом в *H*.
  Базис Рисса является обобщением понятия ортонормированного базиса, а двойное неравенство, данное в определении — обобщение неравенства Бесселя. Другое название базисов Рисса — _базисы, эквивалентные ортонормированным_.
  Система векторов является базисом Рисса тогда и только тогда, когда она может быть получена из ортонормированного базиса с помощью ограниченного обратимого преобразования.

$\mathbb{R}$-вейвлет называется неортогональным, если он не является полуортогональным вейвлетом. Однако, будучи $\mathbb{R}$-вейвлетом, он имеет двойника, и пара $(\psi, \overset{*}{\psi})$ дает возможность формировать семейства $\lbrace\psi_{jk}\rbrace$ и $\lbrace\overset{*}{\psi_{jk}}\rbrace$, удовлетворяющие условию биортогональности $\langle \psi_{jk}, \overset{*}{\psi_{lm}}\rangle = \delta_{jl}\delta_{km}, ~~ j,k,l,m \in \mathbb{Z}$ и позволяющие построить полноцыенные ряды по вейвлетам и реконструкционную формулу.
С необходимостью иметь обратное вейвлет преобразование (или реконструкционную формулу) связано большинство ограничений, накладываемых на вейвлет.

## Построение вейвлета Хаара
Пусть имеем некоторый сигнал $x(t)$, он может быть аппроксимирован взвешенной суммой \textit{импульсных} функций единичтной нормы:
    $$
        x(t) = \sum_i s_i \phi_{[t_j, t_j+1[}~,
    $$
где $\phi_{[t_j, t_{j+1}[}$ функция с окном $t_{j+1} - t_j$ :
    $$
       \phi_{[t_j, t_{j+1}[} =
        \begin{cases}
            1, t \in [t_j, t_{j+1}[ \\
            0, t \not\in [t_j, t_{j+1}[
        \end{cases}
    $$
Возьмем две таке импульсные функции
    $$
        \phi_{[0, 1/2[} =
            \begin{cases}
                1, t \in [0, 1/2[ \\
                0, t \not\in [0, 1/2[
            \end{cases}
        \phi_{[1/2, 1[} =
            \begin{cases}
                1, t \in [1/2, 1[ \\
                0, t \not\in [1/2, 1[
            \end{cases}
    $$
Сумма этих функций дает нам более широкую импульсную функцию
    $$
        \phi_{[0, 1[} =  \phi_{[0, 1/2[} + \phi_{[1/2, 1[} =
            \begin{cases}
                1, t \in [0, 1[ \\
                0, t \not\in [0, 1[
            \end{cases}
    $$
Разность дает нам базовый вейвлет Хаара[@haar]
$$
    \psi =  \phi_{[0, 1/2[} - \phi_{[1/2, 1[} =
        \begin{cases}
           ~~ 1, t \in [0, 1/2[ \\
            -1, t \in [1/2, 1[
        \end{cases}
$$

![График базового вейвлета Хаара](../out/diploma_files/figure-latex/unnamed-chunk-7.pdf) 

Применяя подобные операции получаем бесконечное число функций вида
    $$
        \psi_{jk} = 2^{j/2}\psi(2^j (t - k))~,
    $$
которые вместе с $\phi_{]-\infty, \infty[}$ составляют базис в пространстве $L_2(\mathbb{R})$.

Таким образом $x(t)$ может быть представлен в виде:
$$
    x(t) = s_0\phi_{[0, 1/2[} + s_1 \phi_{[1/2, 1[]} = s_0\frac{\phi_{[0, 1[} + \psi_{[0, 1[}}{2} + s_1\frac{\phi_{[0, 1[} - \psi_{[0, 1[}}{2},
$$
где $(s_0 + s_1)/2$ представляет собой среднее функции(общую картину), а $(s_0 - s_1)/2$ представляет изменение функции (детали). Тем самым получено вейвлет-преобразование Хаара функции $x(t)$.

Пусть $\psi$ такое преобразование $t : \mathbb{R} \rightarrow [-1, 1]$, что
  $$
    \psi(t) =
      \begin{cases}
        -1, ~ t \in [0, \frac{1}{2}[ \\
        1, ~t \in[\frac{1}{2}, 1[ \\
        0, ~t \in \mathbb{R} \setminus [0, 1[
      \end{cases}
  $$

Пусть ткаже $\psi_{jk}$ преобразование $t: \mathbb{R} \rightarrow [-2^j, 2^j]$ такое, что
  $$
    \psi_{jk}(t) = 2^{j/2} \psi(2^j (t - k))
  $$


![Примеры вейвлетов Хаара с различными параметрами смещения и масштабирования](../out/diploma_files/figure-latex/unnamed-chunk-8.pdf) 

## Вейвлет спектр.

В этой части мы введем понятие вейвлет спектра временного ряда, аналогично тому, как вводится понятие спектральной плотности ряда (в смысле преобразования Фурье). 





